Цепочка обязанностей (Chain of Responsibility) в вашей программе представляется использованием нескольких классов-обработчиков сообщений. 
Каждый обработчик знает, может ли он обработать данное сообщение, и если нет, передает управление следующему обработчику в цепочке.

1. **Интерфейс IMessageHandler:**
   - `CanHandle(Message message)`: Метод, который определяет, способен ли текущий обработчик обработать данное сообщение.
   - `HandleAsync(Message message)`: Метод, который выполняет обработку сообщения.

2. **BroadcastHandler:**
   - `CanHandle(Message message)`: Обработчик проверяет, что сообщение не имеет конкретного получателя (Recipient).
   - `HandleAsync(Message message)`: Обработчик отправляет широковещательное сообщение всем подключенным клиентам, исключая отправителя.

3. **RegistrationHandler:**
   - `CanHandle(Message message)`: Обработчик проверяет, содержит ли сообщение команды "register" или "delete".
   - `HandleAsync(Message message)`: Обработчик регистрирует новых клиентов или удаляет существующих в зависимости от команды.

4. **Server Class:**
   - `ProcessCommand(Message msg)`: Метод сервера, который передает сообщение по цепочке обработчиков.
   - Первый обработчик, который может обработать сообщение, выполняет обработку.
   - Это обеспечивает гибкость добавления новых обработчиков и изменения порядка их вызова без изменения кода сервера.

Цепочка обязанностей в вашей программе позволяет эффективно структурировать обработку различных типов сообщений, избегая больших вложенных условий или операторов switch. 
Каждый обработчик ответственен только за свой конкретный тип сообщений, что делает код более читаемым и поддерживаемым.

Классы : 

1. **Message Class:**
    - `Message(string sender, string recipient, string text)`: Конструктор класса `Message`, который инициализирует объект сообщения с указанным отправителем, получателем и текстом.
    - `ToJson()`: Метод, который сериализует объект `Message` в формат JSON.
    - `FromJson(string somemessage)`: Статический метод, который десериализует строку JSON в объект `Message`.
    - `ToString()`: Переопределение метода `ToString()`, чтобы предоставить строковое представление объекта `Message`.

2. **Client Class:**
    - `SendMsg(string name, int localPort, CancellationToken cancellationToken)`:
    - Асинхронный метод, предназначенный для отправки сообщений от клиента. Он инициализирует объект `UdpClient`, устанавливает соединение с сервером и начинает цикл для ввода сообщений пользователя и их отправки серверу. Также запускает асинхронную задачу для приема входящих сообщений.

3. **Server Class:**
    - `AcceptMsg(CancellationToken cancellationToken)`: Асинхронный метод, предназначенный для принятия сообщений на сервере. Инициализирует `UdpClient`, ждет входящих сообщений и обрабатывает их в цикле. Также обрабатывает команды "register" и "delete", регистрируя и удаляя клиентов соответственно.
    - `ProcessCommand(Message msg)`: Метод, обрабатывающий команды от клиента в зависимости от их содержания. Регистрирует/удаляет клиентов или отправляет сообщения всем клиентам.
    - `ReceiveWithCancellationAsync(UdpClient udpClient, CancellationToken cancellationToken)`: Метод для асинхронного приема сообщений с использованием токена отмены.
    - `RequestExit()`: Метод для запроса выхода из программы.

4. **BroadcastHandler Class:**
    - `CanHandle(Message message)`: Метод, определяющий, может ли текущий обработчик обработать данное сообщение. Здесь обрабатываются только сообщения без получателя.
    - `HandleAsync(Message message)`: Метод, обрабатывающий сообщение. В данном случае отправляет широковещательное сообщение всем подключенным клиентам.

5. **RegistrationHandler Class:**
    - `CanHandle(Message message)`: Метод, определяющий, может ли текущий обработчик обработать данное сообщение. Здесь обрабатываются команды "register" и "delete".
    - `HandleAsync(Message message)`: Метод, обрабатывающий сообщение. В данном случае регистрирует или удаляет клиента.

6. **IMessageHandler Interface:**
    - `CanHandle(Message message)`: Метод, который должны реализовывать классы-обработчики для определения, может ли данный обработчик обработать данное сообщение.
    - `HandleAsync(Message message)`: Метод, который должны реализовывать классы-обработчики для выполнения обработки сообщения.

